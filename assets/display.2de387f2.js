import{u as Y,r as h,a,A,j as S,F as _,i as $,R as k,b as B}from"./useMeasure.f9b9459a.js";var F="/assets/vi7th.a14b08ab.jpg";const f=72,H=13,z=5,C=(m,r)=>{var t;const c=[[1,1,1,1,0,1,1,1,0,1,0,0,1],[0,0,0,1,0,0,1,0,0,1,0,0,1],[0,0,1,0,0,0,1,0,0,1,1,1,1],[0,1,0,0,0,0,1,0,0,1,0,0,1],[0,1,0,0,0,0,1,0,0,1,0,0,1]];return((t=c==null?void 0:c[m])==null?void 0:t[r])===1},R=({x:m,y:r,baseX7:c,baseY7:t,imgSrc:o,isFinished:b})=>{const d=C(r-t,m-c),x=!b&&Math.random()<.06;return a("div",{className:`absolute box-border h-[72px] w-[72px] flex overflow-hidden items-center justify-center ${d||!o?"bg-transparent":"bg-white"}`,style:{left:m*f,top:r*f},children:!d&&o&&a("img",{src:o,className:`w-[70px] h-[70px] block object-cover  ${x?"animate-pulse":""}`})})},U=()=>{const[m,{width:r,height:c}]=Y(),{xItemNum:t,yItemNum:o,baseXOffset:b,baseYOffset:d,baseX7:x,baseY7:w}=h.exports.useMemo(()=>{const s=Math.floor(r/f),e=Math.floor(c/f),n=(r-s*f)/2,l=(c-e*f)/2,p=Math.floor((s-H)/2),i=Math.floor((e-z)/2);return{xItemNum:s,yItemNum:e,baseXOffset:n,baseYOffset:l,baseX7:p,baseY7:i}},[r,c]),[u,I]=h.exports.useState([]),[g,N]=h.exports.useState(!1);h.exports.useEffect(()=>{(async()=>{let s=0,e=!1;const n=async(l=0)=>{var p;try{const i=await((p=$.exports.getAuthClient())==null?void 0:p.getCurrentUser()),E=await fetch("https://7th.pingcap.net/query_list?offset="+l,{method:"GET",mode:"cors",headers:new Headers({"Content-Type":"application/json",Authorization:"Bearer "+(i==null?void 0:i.token)})}),{finish:v,next_offset:O,pics:T=[]}=await E.json();l=O,N(v),e=!!v,I(X=>[...X,...T])}catch(i){console.error(i)}e||window.setTimeout(()=>{n(l)},5*1e3)};n(s)})()},[]);const y=h.exports.useMemo(()=>{const e=[...u.slice(0,t*o)];if(e.length<t*o)for(let n=e.length;n<t*o;n+=1)e.push("");return e.sort(()=>Math.random()>.5?-1:1),e},[u,t,o]),M=h.exports.useMemo(()=>{const s=u.sort(()=>Math.random()>.5?-1:1).slice(0,t*o),e=[...s];if(s.length<t*o)for(let n=s.length;n<t*o;n+=1){const l=n%s.length;e.push(s[l])}return e},[u,t,o]),j=g?M:y;return a("div",{className:"h-screen max-h-screen overflow-hidden bg-vi-base lg:min-w-[1280px] flex flex-col pl-2 box-border",children:a(A,{children:S("div",{className:"relative flex-grow",ref:m,children:[a("div",{className:"absolute inset-0 z-0 flex items-center justify-center overflow-hidden opacity-20",children:a("img",{src:F,className:"block object-contain w-full h-full"})}),r?a("div",{className:"z-20",style:{transform:`translate(${b}px, ${d}px)`},children:j.map((s,e)=>a(R,{y:Math.floor(e/t),x:e%t,baseX7:x,baseY7:w,imgSrc:s,isFinished:g},`${e}`))}):a(_,{})]})})})};k.render(a(B.StrictMode,{children:a(U,{})}),document.getElementById("root"));
